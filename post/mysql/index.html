<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="Mr.Lee&#39;s Blog">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="https://dovelee-hub.github.io//img/006K4zUIgy1gc9ws7pt5uj30vm0hsdm3.jpg">
    <meta property="twitter:image" content="https://dovelee-hub.github.io//img/006K4zUIgy1gc9ws7pt5uj30vm0hsdm3.jpg" />
    

    
    <meta name="title" content="MySQL" />
    <meta property="og:title" content="MySQL" />
    <meta property="twitter:title" content="MySQL" />
    

    
    <meta name="description" content="DoveLee,业余程序员, 开源爱好者，生活探险家 | 这里是 DoveLee 的博客，与你一起发现更大的世界。">
    <meta property="og:description" content="DoveLee,业余程序员, 开源爱好者，生活探险家 | 这里是 DoveLee 的博客，与你一起发现更大的世界。" />
    <meta property="twitter:description" content="DoveLee,业余程序员, 开源爱好者，生活探险家 | 这里是 DoveLee 的博客，与你一起发现更大的世界。" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="智, dovelee, DoveLee, DoveLee的网络日志, DoveLee的博客, DoveLeeBlog, 博客, 个人网站, 互联网, Web, 云原生, PaaS, Istio, Kubernetes, 微服务, Microservice">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>MySQL-DoveLee的博客 | DoveLee Blog</title>

    <link rel="canonical" href="/post/mysql/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>
	
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">
    
    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    
    

    
    
    <script src="/js/jquery.min.js"></script>
    
    
    <script src="/js/bootstrap.min.js"></script>
    
    
    <script src="/js/hux-blog.min.js"></script>

    
    

</head>



<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Mr.Lee&#39;s Blog</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                        
                        <li>
                            <a href="/categories/tech">tech</a>
                        </li>
                        
                    
                    
		    
                        <li><a href="/top/books/">BOOKS</a></li>
                    
                        <li><a href="/top/about/">ABOUT</a></li>
                    

                    
		    <li>
                        <a href="/search">SEARCH <img src="/img/search.png" height="15" style="cursor: pointer;" alt="Search"></a>
		    </li>
                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/img/006K4zUIgy1gc9ws7pt5uj30vm0hsdm3.jpg')
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                    </div>
                    <h1>MySQL</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        Posted by 
                        
                                 &#34;Zhi Li&#34;
                         
                        on 
                        Sunday, July 19, 2020
                        
                        
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                post-container">

                
                <header>
                    <h2>TOC</h2>
                </header>
                <nav id="TableOfContents">
  <ul>
    <li><a href="#1初识mysql">1.初识MySQL</a>
      <ul>
        <li><a href="#1-基本的命令行操作">1. 基本的命令行操作</a></li>
      </ul>
    </li>
    <li><a href="#2-操作数据库">2. 操作数据库</a>
      <ul>
        <li><a href="#21-操作数据库了解即可">2.1 操作数据库（了解即可）</a></li>
        <li><a href="#22-数据库的列类型">2.2 数据库的列类型</a></li>
        <li><a href="#23-数据库的字段属性重点">2.3 数据库的字段属性（重点）</a></li>
        <li><a href="#24-创建数据库表重点">2.4 创建数据库表（重点）</a></li>
        <li><a href="#25-数据表的类型">2.5 数据表的类型</a></li>
        <li><a href="#26-修改和删除表">2.6 修改和删除表</a></li>
      </ul>
    </li>
    <li><a href="#3-mysql数据管理">3. MySQL数据管理</a>
      <ul>
        <li><a href="#31-外键了解即可">3.1 外键（了解即可）</a></li>
        <li><a href="#32-dml语言全部记住">3.2 DML语言（全部记住）</a></li>
        <li><a href="#33-添加insert">3.3 添加（insert）</a></li>
        <li><a href="#34--修改update">3.4  修改（update）</a></li>
        <li><a href="#35-删除">3.5 删除</a></li>
      </ul>
    </li>
    <li><a href="#4-dql查询数据最重点">4. DQL查询数据（最重点！）</a>
      <ul>
        <li><a href="#41-dql">4.1 DQL</a></li>
        <li><a href="#42-查询指定字段">4.2 查询指定字段</a></li>
        <li><a href="#43-where条件子句">4.3 where条件子句</a></li>
        <li><a href="#44-联表查询">4.4 联表查询</a></li>
        <li><a href="#45-分页和排序">4.5 分页和排序</a></li>
        <li><a href="#46-子查询">4.6 子查询</a></li>
        <li><a href="#47-分组和过滤">4.7 分组和过滤</a></li>
        <li><a href="#48-select总结">4.8 select总结</a></li>
      </ul>
    </li>
    <li><a href="#5-mysql函数">5. MySQL函数</a>
      <ul>
        <li><a href="#51-sql-aggregate-函数">5.1 SQL Aggregate 函数</a></li>
        <li><a href="#52-sql-scalar-函数">5.2 SQL Scalar 函数</a></li>
        <li><a href="#53-数据库级别的md5加密">5.3 数据库级别的MD5加密</a></li>
      </ul>
    </li>
    <li><a href="#6-事务">6. 事务</a>
      <ul>
        <li><a href="#61-什么是事务">6.1 什么是事务</a></li>
      </ul>
    </li>
    <li><a href="#7-索引">7. 索引</a>
      <ul>
        <li><a href="#71-索引的分类">7.1 索引的分类</a></li>
        <li><a href="#72-索引原则">7.2 索引原则</a></li>
      </ul>
    </li>
    <li><a href="#8-权限管理和备份">8. 权限管理和备份</a>
      <ul>
        <li><a href="#81-用户管理">8.1 用户管理</a></li>
        <li><a href="#82-mysql备份">8.2 MySQL备份</a></li>
      </ul>
    </li>
    <li><a href="#9-规范数据库设计">9. 规范数据库设计</a>
      <ul>
        <li><a href="#91-为什么需要设计数据库">9.1 为什么需要设计数据库</a></li>
        <li><a href="#92-三大范式">9.2 三大范式</a></li>
      </ul>
    </li>
    <li><a href="#10-jdbc">10. JDBC</a>
      <ul>
        <li><a href="#101-数据库驱动">10.1 数据库驱动</a></li>
        <li><a href="#102-jdbc">10.2 JDBC</a></li>
        <li><a href="#103-第一个jdbc程序">10.3 第一个JDBC程序</a></li>
        <li><a href="#104-preparedstatement对象">10.4 PreparedStatement对象</a></li>
        <li><a href="#105-事务">10.5 事务</a></li>
        <li><a href="#106-数据库连接池">10.6 数据库连接池</a></li>
      </ul>
    </li>
  </ul>
</nav>
                
                <h1 id="1初识mysql">1.初识MySQL</h1>
<h2 id="1-基本的命令行操作">1. 基本的命令行操作</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">mysql <span style="color:#ff79c6">-</span>uroot <span style="color:#ff79c6">-</span>p  <span style="color:#6272a4">--连接数据库
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">update</span> mysql.<span style="color:#ff79c6">user</span> <span style="color:#ff79c6">set</span> authentication_string<span style="color:#ff79c6">=</span>password(<span style="color:#f1fa8c">&#39;123456&#39;</span>) <span style="color:#ff79c6">where</span> <span style="color:#ff79c6">user</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;root&#39;</span> <span style="color:#ff79c6">and</span> <span style="color:#ff79c6">Host</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;localhost&#39;</span>;<span style="color:#6272a4">--修改用户密码
</span><span style="color:#6272a4"></span>flush <span style="color:#ff79c6">privileges</span>; <span style="color:#6272a4">--刷新权限
</span><span style="color:#6272a4"></span>
<span style="color:#6272a4">--------------------------------------------------------
</span><span style="color:#6272a4"></span>
<span style="color:#6272a4">--sql中所有语句都用&#39;;&#39;结尾
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">show</span> databases; <span style="color:#6272a4">--查看所有的数据库
</span><span style="color:#6272a4"></span>mysql<span style="color:#ff79c6">&gt;</span> use school <span style="color:#6272a4">--切换数据库：use 数据库名
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">Database</span> changed

<span style="color:#ff79c6">show</span> tables;<span style="color:#6272a4">--查看数据库中所有的表
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">describe</span> student;<span style="color:#6272a4">--显示数据库student中所有的表的信息
</span><span style="color:#6272a4"></span>
<span style="color:#ff79c6">create</span> <span style="color:#ff79c6">database</span> westos; <span style="color:#6272a4">--创建一个数据库
</span><span style="color:#6272a4"></span>
exit; <span style="color:#6272a4">--退出连接
</span></code></pre></div><h1 id="2-操作数据库">2. 操作数据库</h1>
<p>操作数据库-&gt;操作数据库中的表-&gt;操作数据库中表的数据</p>
<p><strong>mysql的关键字不区分大小写</strong></p>
<h2 id="21-操作数据库了解即可">2.1 操作数据库（了解即可）</h2>
<ol>
<li>创建数据库</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#ff79c6">create</span> <span style="color:#ff79c6">database</span> <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">exists</span> lee;
<span style="color:#6272a4">--其中的if not exists可选填
</span></code></pre></div><ol start="2">
<li>删除数据库</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#ff79c6">drop</span> <span style="color:#ff79c6">database</span> <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">exists</span> lee;
<span style="color:#6272a4">----其中的if exists可选填
</span></code></pre></div><ol start="3">
<li>使用数据库</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">use student;
<span style="color:#6272a4">--如果数据库或表或字段的名字是内置关键字（create，user，drop等等），要用`user`而不是user
</span></code></pre></div><ol start="4">
<li>查看数据库</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#ff79c6">show</span> databases ;
<span style="color:#6272a4">--查看所有的数据库
</span></code></pre></div><p>注：记得将语句操作和可视化操作对应</p>
<p>学习思路：</p>
<ul>
<li>对照可视化历史记录查看sql</li>
<li>固定的关键字记牢</li>
</ul>
<h2 id="22-数据库的列类型">2.2 数据库的列类型</h2>
<ul>
<li>
<p>数值</p>
<ul>
<li>tinyint           十分小的数据      1个字节</li>
<li>smallint        较小的数据          2个字节</li>
<li>mdeiumint   中等大小的数据  3个字节</li>
<li><strong>int                  标准的整数          4个字节    &mdash;&mdash;-&gt;常用</strong></li>
<li>bigint             较大的数据          8个字节</li>
<li>float               浮点数                  4个字节</li>
<li>double           浮点数                  8个字节</li>
<li>decimal         字符串形式的浮点数            &mdash;&mdash;&ndash;&gt;金融计算的时候，一般用decimal</li>
</ul>
</li>
<li>
<p>字符串</p>
<ul>
<li>char          字符串固定大小        0~255</li>
<li><strong>varchar     可变字符串               0~65535  &mdash;&mdash;-&gt;常用</strong></li>
<li>tingtext     微型文本                   可存2^8-1个字符</li>
<li><strong>Text           文本串                        2^16-1   &mdash;&mdash;&mdash;-&gt;保存大文本</strong></li>
</ul>
</li>
<li>
<p>时间日期</p>
<ul>
<li>date   YYYY-MM-DD   日期格式</li>
<li>time   HH:mm:ss        时间格式</li>
<li><strong>datetime     YYYY-MM-DD  HH:mm:ss  最常用的时间格式</strong></li>
<li><strong>timestamp     时间戳   1970.1.1到现在的毫秒数    也较为常用</strong></li>
<li>year 年份表示</li>
</ul>
</li>
<li>
<p>null</p>
<ul>
<li>没有值，未知</li>
<li>注意：不要使用null进行运算</li>
</ul>
</li>
</ul>
<h2 id="23-数据库的字段属性重点">2.3 数据库的字段属性（重点）</h2>
<ul>
<li>
<p>Unsigned</p>
<ul>
<li>无符号的整数</li>
<li>声明了该列不能为负数不能声明为负数</li>
</ul>
</li>
<li>
<p>zerofill</p>
<ul>
<li>不足的位数用0填充</li>
</ul>
</li>
<li>
<p>auto_increment</p>
<ul>
<li>自增，自动在上一条记录的基础上+1（默认）</li>
<li>通常用来设计唯一的主键，必须是整数类型</li>
<li>可以自定义设计主键自增的起始值和步长</li>
</ul>
</li>
<li>
<p>not null</p>
<ul>
<li>非空，假设如果不给它赋值，就会报错</li>
<li>相反，null，如果不填写值，默认为空</li>
</ul>
</li>
<li>
<p>默认：</p>
<ul>
<li>设置默认的值</li>
</ul>
</li>
</ul>
<p>拓展：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#6272a4">/*
</span><span style="color:#6272a4">编程规范：
</span><span style="color:#6272a4">每一个表都必须存在以下五个字段
</span><span style="color:#6272a4">id 主键
</span><span style="color:#6272a4">`version`  版本号（乐观锁）
</span><span style="color:#6272a4">is_delete  伪删除
</span><span style="color:#6272a4">gmt_delete 创建时间
</span><span style="color:#6272a4">gmt_update 修改时间
</span><span style="color:#6272a4">*/</span>
</code></pre></div><h2 id="24-创建数据库表重点">2.4 创建数据库表（重点）</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#ff79c6">create</span> <span style="color:#ff79c6">table</span> <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">exists</span> <span style="color:#ff79c6">`</span>MyStudent<span style="color:#ff79c6">`</span>(
    <span style="color:#ff79c6">`</span>id<span style="color:#ff79c6">`</span> <span style="color:#8be9fd;font-style:italic">int</span>(<span style="color:#bd93f9">4</span>) <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">null</span> auto_increment <span style="color:#ff79c6">comment</span> <span style="color:#f1fa8c">&#39;学号&#39;</span>,
    <span style="color:#ff79c6">`</span>name<span style="color:#ff79c6">`</span> <span style="color:#8be9fd;font-style:italic">varchar</span>(<span style="color:#bd93f9">30</span>) <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">null</span> <span style="color:#ff79c6">default</span> <span style="color:#f1fa8c">&#39;匿名&#39;</span> <span style="color:#ff79c6">comment</span>  <span style="color:#f1fa8c">&#39;姓名&#39;</span>,
    <span style="color:#ff79c6">`</span>pwd<span style="color:#ff79c6">`</span>  <span style="color:#8be9fd;font-style:italic">varchar</span>(<span style="color:#bd93f9">20</span>) <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">null</span> <span style="color:#ff79c6">default</span> <span style="color:#f1fa8c">&#39;123456&#39;</span> <span style="color:#ff79c6">comment</span> <span style="color:#f1fa8c">&#39;密码&#39;</span>,
    <span style="color:#ff79c6">`</span>sex<span style="color:#ff79c6">`</span>  <span style="color:#8be9fd;font-style:italic">varchar</span>(<span style="color:#bd93f9">2</span>)  <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">null</span> <span style="color:#ff79c6">default</span> <span style="color:#f1fa8c">&#39;男&#39;</span><span style="color:#ff79c6">comment</span> <span style="color:#f1fa8c">&#39;性别&#39;</span>,
    <span style="color:#ff79c6">`</span>birthday<span style="color:#ff79c6">`</span> datetime <span style="color:#ff79c6">default</span> <span style="color:#ff79c6">null</span> <span style="color:#ff79c6">comment</span> <span style="color:#f1fa8c">&#39;生日&#39;</span>,
    <span style="color:#ff79c6">`</span>address<span style="color:#ff79c6">`</span> <span style="color:#8be9fd;font-style:italic">varchar</span>(<span style="color:#bd93f9">100</span>) <span style="color:#ff79c6">default</span> <span style="color:#ff79c6">null</span> <span style="color:#ff79c6">comment</span> <span style="color:#f1fa8c">&#39;地址&#39;</span>,
    <span style="color:#ff79c6">`</span>email<span style="color:#ff79c6">`</span> <span style="color:#8be9fd;font-style:italic">varchar</span>(<span style="color:#bd93f9">50</span>) <span style="color:#ff79c6">default</span> <span style="color:#ff79c6">null</span> <span style="color:#ff79c6">comment</span> <span style="color:#f1fa8c">&#39;邮箱&#39;</span>,
    <span style="color:#ff79c6">primary</span> <span style="color:#ff79c6">key</span> (<span style="color:#ff79c6">`</span>id<span style="color:#ff79c6">`</span>)
)engine<span style="color:#ff79c6">=</span>INNODB <span style="color:#ff79c6">DEFAULT</span> CHARSET<span style="color:#ff79c6">=</span>utf8;
</code></pre></div><p>常用命令</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#ff79c6">show</span> <span style="color:#ff79c6">create</span> <span style="color:#ff79c6">database</span> student;
<span style="color:#ff79c6">#</span> 查看创建数据库的语句
<span style="color:#ff79c6">show</span> <span style="color:#ff79c6">create</span> <span style="color:#ff79c6">table</span> MyStudent;
<span style="color:#ff79c6">#</span> 查看MyStudent数据表的定义语句
<span style="color:#ff79c6">desc</span> MyStudent;
<span style="color:#ff79c6">#</span> 显示表的结构
</code></pre></div><h2 id="25-数据表的类型">2.5 数据表的类型</h2>
<p>INNODB 默认使用</p>
<p>MYISAM 早些年使用</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">MYISAM</th>
<th align="center">INNODB</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">事务支持</td>
<td align="center">不支持</td>
<td align="center">支持</td>
</tr>
<tr>
<td align="center">数据行锁定</td>
<td align="center">不支持（表锁）</td>
<td align="center">支持</td>
</tr>
<tr>
<td align="center">外键约束</td>
<td align="center">不支持</td>
<td align="center">支持</td>
</tr>
<tr>
<td align="center">全文索引</td>
<td align="center">支持</td>
<td align="center">支持</td>
</tr>
<tr>
<td align="center">表空间的大小</td>
<td align="center">较小</td>
<td align="center">较大，约为2倍</td>
</tr>
</tbody>
</table>
<p>常规使用操作：</p>
<ul>
<li>MYIASM 节约空间，速度较快</li>
<li>INNODB 安全性高，事务的处理，多表多用户操作</li>
</ul>
<p><strong>在物理空间存在的位置</strong></p>
<p>所有的数据库文件都存在/usr/local/mysql/data目录下(MacOS)</p>
<p>本质还是文件的存储</p>
<p>MySQL引擎在物理文件上的区别</p>
<ul>
<li>INNODB 在数据库表中只有一个 *.frm 文件，以及上级目录下的ibdata1文件</li>
<li>MYISAN对应文件
<ul>
<li>*.frm   表结构的定义文件</li>
<li>*.MYD 数据文件（data）</li>
<li>*.MYI  索引文件（index）</li>
</ul>
</li>
</ul>
<p><strong>设置数据库的字符集编码</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">CHARST<span style="color:#ff79c6">=</span>utf8
</code></pre></div><p>不设置的话，会使MySQL默认的字符集编码Latin1（不支持中文）</p>
<p>也可以在my.ini文件中配制默认的编码（不建议这么使用，会降低代码的通用性（在别人的电脑上就乱码了））</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ini" data-lang="ini"><span style="color:#50fa7b">character-set-server</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">utf8</span>
</code></pre></div><h2 id="26-修改和删除表">2.6 修改和删除表</h2>
<p><strong>修改</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#ff79c6">alter</span> <span style="color:#ff79c6">table</span> MyStudent <span style="color:#ff79c6">rename</span> <span style="color:#ff79c6">as</span> Student1;
<span style="color:#6272a4"># 修改表名
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">alter</span> <span style="color:#ff79c6">table</span> Student1 <span style="color:#ff79c6">add</span> age <span style="color:#8be9fd">INT</span>(<span style="color:#bd93f9">3</span>);
<span style="color:#6272a4"># 增加表的字段
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">alter</span> <span style="color:#ff79c6">table</span> Student1 modify age <span style="color:#8be9fd">varchar</span>(<span style="color:#bd93f9">3</span>);<span style="color:#6272a4">#修改约束
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">alter</span> <span style="color:#ff79c6">table</span> Student1 <span style="color:#ff79c6">change</span> age age1 <span style="color:#8be9fd">INT</span>(<span style="color:#bd93f9">3</span>);<span style="color:#6272a4">#字段重命名及修改约束
</span><span style="color:#6272a4"># 修改表的字段（重命名，修改约束）
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">alter</span> <span style="color:#ff79c6">table</span> Student <span style="color:#ff79c6">drop</span> age1;
<span style="color:#6272a4">#删除表的字段
</span></code></pre></div><p><strong>删除</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#ff79c6">drop</span> <span style="color:#ff79c6">table</span> <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">exists</span> Student1;
<span style="color:#6272a4">#删除表
</span></code></pre></div><blockquote>
<p>所有的创建和删除尽量加上判断，以免报错</p>
</blockquote>
<h1 id="3-mysql数据管理">3. MySQL数据管理</h1>
<h2 id="31-外键了解即可">3.1 外键（了解即可）</h2>
<p><img src="https://user-images.githubusercontent.com/58317994/87657003-d28c9980-c78c-11ea-8c4e-09328634302f.jpg" alt=""></p>
<p>不建议使用物理外键（数据库级别的外键），造成表在物理层面之间产生关联，DELETE或者UPDATE都必须考虑外键约束，会导致开发的时候很麻烦，测试数据极为不方便</p>
<p>最佳方法：</p>
<ul>
<li>数据库就是单纯的表，只用来存放数据，只有行（数据）和列（字段）</li>
<li>通过程序去实现外键</li>
</ul>
<h2 id="32-dml语言全部记住">3.2 DML语言（全部记住）</h2>
<p>数据库意义：数据存储，数据管理</p>
<p>DML语言：数据操作语言</p>
<ul>
<li>insert</li>
<li>update</li>
<li>delete</li>
</ul>
<h2 id="33-添加insert">3.3 添加（insert）</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#ff79c6">insert</span> <span style="color:#ff79c6">into</span> 表名(字段名<span style="color:#bd93f9">1</span>,字段名<span style="color:#bd93f9">2</span>,字段名<span style="color:#bd93f9">3</span>)<span style="color:#ff79c6">values</span>(<span style="color:#f1fa8c">&#39;值1&#39;</span>),(<span style="color:#f1fa8c">&#39;值2&#39;</span>),(<span style="color:#f1fa8c">&#39;值3&#39;</span>),......；
<span style="color:#6272a4">#一般写插入语句，我们一定要数据和字段一一对应
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">insert</span> <span style="color:#ff79c6">into</span> <span style="color:#ff79c6">`</span>grade<span style="color:#ff79c6">`</span>(<span style="color:#ff79c6">`</span>Name<span style="color:#ff79c6">`</span>,<span style="color:#ff79c6">`</span>GradeID<span style="color:#ff79c6">`</span>)<span style="color:#ff79c6">values</span> (<span style="color:#f1fa8c">&#39;张三&#39;</span>,<span style="color:#f1fa8c">&#39;大一&#39;</span>),(<span style="color:#f1fa8c">&#39;李四&#39;</span>,<span style="color:#f1fa8c">&#39;大三&#39;</span>);
<span style="color:#6272a4">#字段名可以省略，但是要数据要和所有字段一一对应（不建议这么写）
</span><span style="color:#6272a4">#由于主键自增，可以省略不写
</span></code></pre></div><h2 id="34--修改update">3.4  修改（update）</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#6272a4">#语法：
</span><span style="color:#6272a4">#update 表名 set 列名 = 修改后的数据 where 条件
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">update</span> <span style="color:#ff79c6">`</span>grade<span style="color:#ff79c6">`</span> <span style="color:#8be9fd">set</span> <span style="color:#ff79c6">`</span>Name<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;李&#39;</span> <span style="color:#ff79c6">where</span> <span style="color:#ff79c6">`</span>GradeID<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;大一&#39;</span>;

<span style="color:#6272a4">#如果不指定条件（where），会改动整个表
</span><span style="color:#6272a4"></span>
<span style="color:#6272a4">#修改多个属性，逗号隔开
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">update</span> <span style="color:#ff79c6">`</span>grade<span style="color:#ff79c6">`</span> <span style="color:#8be9fd">set</span> <span style="color:#ff79c6">`</span>Name<span style="color:#ff79c6">`=</span><span style="color:#f1fa8c">&#39;刘&#39;</span>,<span style="color:#ff79c6">`</span>GradeID<span style="color:#ff79c6">`=</span><span style="color:#f1fa8c">&#39;大三&#39;</span> <span style="color:#ff79c6">where</span> <span style="color:#ff79c6">`</span>GradeID<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;大一&#39;</span>;
</code></pre></div><p>条件：where子句</p>
<p>操作符除了=,!=,&lt;,&gt;,&lt;=,&gt;=还有between&hellip;and&hellip;（在某个范围内），and（逻辑与），or（逻辑或）</p>
<h2 id="35-删除">3.5 删除</h2>
<p>delete命令：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#6272a4">#删除所有数据（不推荐）
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">delete</span> <span style="color:#ff79c6">from</span> 表名;

<span style="color:#6272a4">#删除指定数据
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">delete</span> <span style="color:#ff79c6">from</span> 表名 <span style="color:#ff79c6">where</span> 条件;
</code></pre></div><p>truncate命令：</p>
<p>作用：完全清空一个数据库表，表的结构和索引约束不会变</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#6272a4">#清空表
</span><span style="color:#6272a4"></span>truncate 表名;
</code></pre></div><p>delete和truncate关系：</p>
<ul>
<li>相同点：都能删除数据，都不会删除表结构</li>
<li>不同点：
<ul>
<li>truncate 重新设置自增列，计数器会归零</li>
<li>truncate 不会影响事务</li>
</ul>
</li>
</ul>
<h1 id="4-dql查询数据最重点">4. DQL查询数据（最重点！）</h1>
<h2 id="41-dql">4.1 DQL</h2>
<p>Data Query Language：数据查询语言</p>
<ul>
<li>所有的查询操作都用它 关键词：Select</li>
<li>简单的查询，复杂的查询都能做</li>
<li>数据库中最核心的语言</li>
<li>使用频率最高的语句</li>
</ul>
<h2 id="42-查询指定字段">4.2 查询指定字段</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#6272a4">-- 查询指定字段 select 字段 from 表
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">`</span>studentno<span style="color:#ff79c6">`</span> , <span style="color:#ff79c6">`</span>studentname<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">from</span> student;
<span style="color:#6272a4">-- 查询全部的学生
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">from</span> student;
<span style="color:#6272a4">-- 用as给查到的字段或者表起个别名
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">`</span>studentno<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">as</span> 学号, <span style="color:#ff79c6">`</span>studentname<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">as</span> 学生姓名 <span style="color:#ff79c6">from</span> student;
<span style="color:#6272a4">-- 函数concat(a,b)拼接字符串
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span>  <span style="color:#50fa7b">concat</span>(<span style="color:#f1fa8c">&#39;姓名：&#39;</span>,studentname) <span style="color:#ff79c6">from</span> student;
<span style="color:#6272a4">-- 学员考试成绩全部+1分查看
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">`</span>studentno<span style="color:#ff79c6">`</span>,<span style="color:#ff79c6">`</span>studentresult<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">as</span> 提分前,<span style="color:#ff79c6">`</span>studentresult<span style="color:#ff79c6">`+</span><span style="color:#bd93f9">1</span> <span style="color:#ff79c6">as</span> 提分后 <span style="color:#ff79c6">from</span> result;
</code></pre></div><p><img src="https://user-images.githubusercontent.com/58317994/87692351-4004ee00-c7be-11ea-98c2-d30cbc22d5bf.jpg" alt=""></p>
<p><img src="https://user-images.githubusercontent.com/58317994/87692406-4dba7380-c7be-11ea-8d81-138f1d5b10ca.jpg" alt=""></p>
<p><img src="https://user-images.githubusercontent.com/58317994/87693825-ffa66f80-c7bf-11ea-9745-c7199c3f5631.jpg" alt=""></p>
<p>去重：distinct</p>
<p>作用：去除select查询出来的结果中重复的数据，重复的数据只显示一条</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#6272a4">-- 查询一下哪些同学有成绩
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">from</span> result;<span style="color:#6272a4">-- 查询全部的考试成绩
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">`</span>studentno<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">from</span> result; <span style="color:#6272a4">-- 查询有哪些同学参加了考试
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">distinct</span> <span style="color:#ff79c6">`</span>studentno<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">from</span> result; <span style="color:#6272a4">-- 发现重复数据，去重
</span></code></pre></div><p>select的其他用法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#ff79c6">select</span> <span style="color:#50fa7b">version</span>(); <span style="color:#6272a4">-- 查询版本号
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#bd93f9">100</span><span style="color:#ff79c6">*</span><span style="color:#bd93f9">3</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>;  <span style="color:#6272a4">-- 用来计算
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">@@</span>auto_increment_increment;  <span style="color:#6272a4">-- 查询自增的步长
</span></code></pre></div><p>公式：select 表达式 from 表 where 条件</p>
<p>数据库中的表达式：文本值，列，null，函数，计算表达式，系统变量</p>
<h2 id="43-where条件子句">4.3 where条件子句</h2>
<p>作用：检索数据中符合条件的值</p>
<table>
<thead>
<tr>
<th align="left">运算符分类</th>
<th>运算符</th>
<th>运算符介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">比较运算符</td>
<td>&gt;  &lt;  &lt;=  &gt;=  =  &lt;&gt;</td>
<td>大于、小于、大于(小于)等于、不等于</td>
</tr>
<tr>
<td align="left"></td>
<td>BETWEEN &hellip;AND&hellip;</td>
<td>显示在某一区间的值</td>
</tr>
<tr>
<td align="left"></td>
<td>a IN (a1,a2,a3&hellip;&hellip;)</td>
<td>如果a在a1,a2&hellip;&hellip;其中某一各中，结果为真</td>
</tr>
<tr>
<td align="left"></td>
<td>a LIKE b</td>
<td>模糊查询，SQL匹配，如果a匹配b,则结果为真</td>
</tr>
<tr>
<td align="left"></td>
<td>IS NULL</td>
<td>判断是否为空</td>
</tr>
<tr>
<td align="left">逻辑运算符</td>
<td>and  &amp;&amp;</td>
<td>多个条件同时成立</td>
</tr>
<tr>
<td align="left"></td>
<td>or  ||</td>
<td>多个条件任一成立</td>
</tr>
<tr>
<td align="left"></td>
<td>not  !</td>
<td>不成立，例：where not(salary&gt;100);</td>
</tr>
</tbody>
</table>
<p>模糊查询：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#6272a4">-- 查询姓赵的同学
</span><span style="color:#6272a4">-- like结合%(代表0到任意个字符)
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">`</span>studentno<span style="color:#ff79c6">`</span>,<span style="color:#ff79c6">`</span>studentname<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">from</span> <span style="color:#ff79c6">`</span>student<span style="color:#ff79c6">`</span>
<span style="color:#ff79c6">where</span> studentname <span style="color:#ff79c6">like</span> <span style="color:#f1fa8c">&#39;赵%&#39;</span>;

<span style="color:#6272a4">-- 查询姓赵的同学，姓后面只有一个字的(几个字几个_)
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">`</span>studentno<span style="color:#ff79c6">`</span>,<span style="color:#ff79c6">`</span>studentname<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">from</span> <span style="color:#ff79c6">`</span>student<span style="color:#ff79c6">`</span>
<span style="color:#ff79c6">where</span> studentname <span style="color:#ff79c6">like</span> <span style="color:#f1fa8c">&#39;赵_&#39;</span>;

<span style="color:#6272a4">-- 查询名字中间带有智的同学
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">`</span>studentno<span style="color:#ff79c6">`</span>,<span style="color:#ff79c6">`</span>studentname<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">from</span> <span style="color:#ff79c6">`</span>student<span style="color:#ff79c6">`</span>
<span style="color:#ff79c6">where</span> studentname <span style="color:#ff79c6">like</span> <span style="color:#f1fa8c">&#39;%智%&#39;</span>;

<span style="color:#6272a4">-- 查询1000，1001号学员
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">`</span>studentno<span style="color:#ff79c6">`</span>,<span style="color:#ff79c6">`</span>studentname<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">from</span> <span style="color:#ff79c6">`</span>student<span style="color:#ff79c6">`</span>
<span style="color:#ff79c6">where</span> studentno <span style="color:#ff79c6">in</span> (<span style="color:#bd93f9">1000</span>,<span style="color:#bd93f9">1001</span>);
<span style="color:#6272a4">-- in(此处放具体的一个或多个值，不能用%和_)
</span></code></pre></div><h2 id="44-联表查询">4.4 联表查询</h2>
<p><strong>join</strong></p>
<p><img src="https://www.runoob.com/wp-content/uploads/2019/01/sql-join.png" alt=""></p>
<ul>
<li><strong>INNER JOIN</strong>：如果表中有至少一个匹配，则返回行</li>
<li><strong>LEFT JOIN</strong>：即使右表中没有匹配，也从左表返回所有的行</li>
<li><strong>RIGHT JOIN</strong>：即使左表中没有匹配，也从右表返回所有的行</li>
<li><strong>FULL JOIN</strong>：只要其中一个表中存在匹配，则返回行（MySQL不支持）</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#6272a4">-- 查询参加了考试的同学（学号，姓名，科目编号，分数）
</span><span style="color:#6272a4"># 思路
</span><span style="color:#6272a4"># 分析需求，分析查询的字段来自哪些表，如果来自不同的表（联表查询）
</span><span style="color:#6272a4"># 确定使用哪种连接查询（7种） 确定交集
</span><span style="color:#6272a4"></span>
<span style="color:#ff79c6">select</span> s.studentno,studentname,subjectno,studentresult
<span style="color:#ff79c6">from</span> student <span style="color:#ff79c6">as</span> s
<span style="color:#ff79c6">inner</span> <span style="color:#ff79c6">join</span>  result <span style="color:#ff79c6">as</span> r
<span style="color:#ff79c6">where</span> s.studentno <span style="color:#ff79c6">=</span> r.subjectno;

<span style="color:#ff79c6">select</span> s.studentno,studentname,subjectno,studentresult
<span style="color:#ff79c6">from</span> student <span style="color:#ff79c6">as</span> s
<span style="color:#ff79c6">right</span> <span style="color:#ff79c6">join</span> result <span style="color:#ff79c6">as</span> r
<span style="color:#ff79c6">on</span> s.studentno <span style="color:#ff79c6">=</span> r.subjectno <span style="color:#6272a4">-- on是先筛选后关联（只能搭配join用），where是先关联后筛选
</span></code></pre></div><blockquote>
<p>详见菜鸟教程https://www.runoob.com/sql/sql-join.html</p>
</blockquote>
<h2 id="45-分页和排序">4.5 分页和排序</h2>
<p>排序（order by）：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#6272a4">-- 排序：升序 ASC 降序 DESC
</span><span style="color:#6272a4">-- 根据查询的结果排序
</span><span style="color:#6272a4">-- order by 通过哪个字段排序 怎么排（ASC/DESC）
</span></code></pre></div><p>分页(limit)：</p>
<ul>
<li>环节数据库压力</li>
<li>提升用户体验</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">from</span> tableName <span style="color:#ff79c6">limit</span> i,n
<span style="color:#6272a4"># tableName：表名
</span><span style="color:#6272a4"># i：为查询结果的索引值(默认从0开始)，当i=0时可省略i
</span><span style="color:#6272a4"># n：为查询结果返回的数量
</span><span style="color:#6272a4"># i与n之间使用英文逗号&#34;,&#34;隔开
</span><span style="color:#6272a4"></span>
<span style="color:#6272a4"># 
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">limit</span> n 等同于 <span style="color:#ff79c6">limit</span> <span style="color:#bd93f9">0</span>,n

<span style="color:#6272a4"># 查询10条数据，索引从0到9，第1条记录到第10条记录
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">from</span> t_user <span style="color:#ff79c6">limit</span> <span style="color:#bd93f9">10</span>;
<span style="color:#ff79c6">select</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">from</span> t_user <span style="color:#ff79c6">limit</span> <span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">10</span>;

<span style="color:#6272a4"># 查询8条数据，索引从5到12，第6条记录到第13条记录
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">from</span> t_user <span style="color:#ff79c6">limit</span> <span style="color:#bd93f9">5</span>,<span style="color:#bd93f9">8</span>;
</code></pre></div><h2 id="46-子查询">4.6 子查询</h2>
<p>本质：在where语句中嵌套子查询语句</p>
<p>实例：https://www.cnblogs.com/fzxey/p/10896244.html</p>
<h2 id="47-分组和过滤">4.7 分组和过滤</h2>
<p>group by:</p>
<p>GROUP BY 语句用于结合聚合函数，根据一个或多个列对结果集进行分组。</p>
<blockquote>
<p>比如想要搜索：科目名称 科目分数均值 科目分数最高值</p>
<p>如果不用group by 那么只会出现一行，即将所有科目的分数求均值和最大值</p>
<p>但如果使用group by 科目名称 则会得出每个科目的分数均值和最大值</p>
</blockquote>
<p><a href="https://www.runoob.com/sql/sql-groupby.html">https://www.runoob.com/sql/sql-groupby.html</a></p>
<p>having:</p>
<p>在 SQL 中增加 HAVING 子句原因是，WHERE 关键字无法与聚合函数一起使用。</p>
<p>HAVING 子句可以让我们筛选分组后的各组数据。</p>
<p><a href="https://www.runoob.com/sql/sql-having.html">https://www.runoob.com/sql/sql-having.html</a></p>
<h2 id="48-select总结">4.8 select总结</h2>
<p><img src="https://user-images.githubusercontent.com/58317994/87849273-cda92080-c919-11ea-97f3-3e1bf175b81a.jpg" alt=""></p>
<h1 id="5-mysql函数">5. MySQL函数</h1>
<p>官方文档：https://dev.mysql.com/doc/refman/5.6/en/function-reference.html</p>
<p>菜鸟教程：https://www.runoob.com/sql/sql-function.html</p>
<h2 id="51-sql-aggregate-函数">5.1 SQL Aggregate 函数</h2>
<p>SQL Aggregate 函数计算从列中取得的值，返回一个单一的值。</p>
<p>有用的 Aggregate 函数：</p>
<ul>
<li>
<p>AVG() - 返回平均值</p>
</li>
<li>
<p>COUNT() - 返回行数</p>
<ul>
<li>
<p>count（*）和count（1）和count（列名）的区别：</p>
<p>从执行结果来说：</p>
<pre><code>count（1）和count（*）之间没有区别，因为count（*）count（1）都不会去过滤空值，
    
但count（列名）就有区别了，因为count（列名）会去过滤空值。
</code></pre>
<p>从执行效率来说：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"> 他们之间根据不同情况会有些许区别，MySQL会对count（<span style="color:#ff79c6">*</span>）做优化。
    
（<span style="color:#bd93f9">1</span>）如果列为主键，<span style="color:#50fa7b">count</span>(列名)效率优于<span style="color:#50fa7b">count</span>(<span style="color:#bd93f9">1</span>)  
    
（<span style="color:#bd93f9">2</span>）如果列不为主键，<span style="color:#50fa7b">count</span>(<span style="color:#bd93f9">1</span>)效率优于<span style="color:#50fa7b">count</span>(列名)  
    
（<span style="color:#bd93f9">3</span>）如果表中存在主键，<span style="color:#50fa7b">count</span>(主键列名)效率最优  
    
（<span style="color:#bd93f9">4</span>）如果表中只有一列，则<span style="color:#50fa7b">count</span>(<span style="color:#ff79c6">*</span>)效率最优  
    
（<span style="color:#bd93f9">5</span>）如果表有多列，且不存在主键，则<span style="color:#50fa7b">count</span>(<span style="color:#bd93f9">1</span>)效率优于<span style="color:#50fa7b">count</span>(<span style="color:#ff79c6">*</span>)
</code></pre></div></li>
</ul>
<p>count(1)，其实就是计算一共有多少符合条件的行。
1并不是表示第一个字段，而是表示一个固定值。
其实就可以想成表中有这么一个字段，这个字段就是固定值1，count(1)，就是计算一共有多少个1.</p>
<p>count(*)，执行时会把星号翻译成字段的具体名字，效果也是一样的，不过多了一个翻译的动作，比固定值的方式效率稍微低一些。</p>
<blockquote>
<p>原文链接：https://blog.csdn.net/qq_34696236/article/details/84376507</p>
</blockquote>
</li>
<li>
<p>FIRST() - 返回第一个记录的值</p>
</li>
<li>
<p>LAST() - 返回最后一个记录的值</p>
</li>
<li>
<p>MAX() - 返回最大值</p>
</li>
<li>
<p>MIN() - 返回最小值</p>
</li>
<li>
<p>SUM() - 返回总和</p>
</li>
</ul>
<hr>
<h2 id="52-sql-scalar-函数">5.2 SQL Scalar 函数</h2>
<p>SQL Scalar 函数基于输入值，返回一个单一的值。</p>
<p>有用的 Scalar 函数：</p>
<ul>
<li>UCASE() - 将某个字段转换为大写</li>
<li>LCASE() - 将某个字段转换为小写</li>
<li>MID() - 从某个文本字段提取字符，MySql 中使用</li>
<li>SubString(字段，1，end) - 从某个文本字段提取字符</li>
<li>LEN() - 返回某个文本字段的长度</li>
<li>ROUND() - 对某个数值字段进行指定小数位数的四舍五入</li>
<li>NOW() - 返回当前的系统日期和时间</li>
<li>FORMAT() - 格式化某个字段的显示方式</li>
</ul>
<h2 id="53-数据库级别的md5加密">5.3 数据库级别的MD5加密</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#ff79c6">create</span> <span style="color:#ff79c6">table</span>  <span style="color:#ff79c6">`</span>testmd5<span style="color:#ff79c6">`</span>(
    <span style="color:#ff79c6">`</span>id<span style="color:#ff79c6">`</span> <span style="color:#8be9fd">int</span>(<span style="color:#bd93f9">4</span>) <span style="color:#ff79c6">not</span> null ,
    <span style="color:#ff79c6">`</span>name<span style="color:#ff79c6">`</span> <span style="color:#8be9fd">varchar</span>(<span style="color:#bd93f9">20</span>) <span style="color:#ff79c6">not</span> null ,
    <span style="color:#ff79c6">`</span>pwd<span style="color:#ff79c6">`</span> <span style="color:#8be9fd">varchar</span>(<span style="color:#bd93f9">20</span>) <span style="color:#ff79c6">not</span> null ,
    <span style="color:#ff79c6">primary</span> <span style="color:#ff79c6">key</span> (<span style="color:#ff79c6">`</span>id<span style="color:#ff79c6">`</span>)
)<span style="color:#ff79c6">engine</span> <span style="color:#ff79c6">=</span> INNODB <span style="color:#ff79c6">default</span> <span style="color:#ff79c6">charset</span> <span style="color:#ff79c6">=</span> utf8;

<span style="color:#6272a4">-- 明文密码
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">insert</span> <span style="color:#ff79c6">into</span> testmd5 <span style="color:#ff79c6">values</span> (<span style="color:#bd93f9">1</span>,<span style="color:#f1fa8c">&#39;zhangsn&#39;</span>,<span style="color:#f1fa8c">&#39;123456&#39;</span>),(<span style="color:#bd93f9">2</span>,<span style="color:#f1fa8c">&#39;lisi&#39;</span>,<span style="color:#f1fa8c">&#39;7890&#39;</span>),(<span style="color:#bd93f9">3</span>,<span style="color:#f1fa8c">&#39;wangermazi&#39;</span>,<span style="color:#f1fa8c">&#39;23333&#39;</span>);

<span style="color:#6272a4">-- 加密
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">update</span> testmd5 <span style="color:#8be9fd">set</span> pwd <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">MD5</span>(pwd) <span style="color:#ff79c6">where</span> id <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>;
<span style="color:#ff79c6">update</span> testmd5 <span style="color:#8be9fd">set</span> pwd <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">MD5</span>(pwd); <span style="color:#6272a4">-- 全部加密
</span><span style="color:#6272a4"></span>
<span style="color:#6272a4">-- 插入的时候加密
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">insert</span> <span style="color:#ff79c6">into</span> testmd5 <span style="color:#ff79c6">values</span> (<span style="color:#bd93f9">4</span>,<span style="color:#f1fa8c">&#39;xiaohong&#39;</span>,<span style="color:#50fa7b">MD5</span>(<span style="color:#f1fa8c">&#39;123456&#39;</span>));

<span style="color:#6272a4">-- 如何校验：将用户传进来的密码，进行md5加密，然后比对加密后的值
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">from</span> testmd5 <span style="color:#ff79c6">where</span> <span style="color:#ff79c6">`</span>name<span style="color:#ff79c6">`=</span><span style="color:#f1fa8c">&#39;xiaohong&#39;</span> <span style="color:#ff79c6">and</span> pwd <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">md5</span>(<span style="color:#f1fa8c">&#39;123456&#39;</span>);
</code></pre></div><h1 id="6-事务">6. 事务</h1>
<h2 id="61-什么是事务">6.1 什么是事务</h2>
<blockquote>
<p>要么都成功要么都失败（银行转账）</p>
</blockquote>
<p>将一组SQL放在一个批次中去执行</p>
<blockquote>
<p>参考博客：https://blog.csdn.net/dengjili/article/details/82468576</p>
</blockquote>
<p>事务原则：ACID原则 原子性，一致性，隔离性，持久性</p>
<p>原子性：要么都成功，要么都失败</p>
<p>一致性：事务前后的数据完整性要一致（不论怎么转账，钱总数不变）</p>
<p>持久性：事务一但提交则不可逆，被持久化到数据库中</p>
<p>隔离性：在并发环境中，并发的事务是相互隔离的，一个事务的执行不能被其他事务干扰。</p>
<p>不隔离所导致的问题：</p>
<p>脏读：一个事务读取了另外一个事务未提交的数据。</p>
<p>不可重复读：在一个事务内读取表中的某一行数据，多次读取结果不同。</p>
<p>虚读（幻读）：在一个事务内读取到了别的事务插入的数据，导致前后读取不一致。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#6272a4">-- MySQL自动开启事务
</span><span style="color:#6272a4"></span><span style="color:#8be9fd">set</span> autocommit  <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; <span style="color:#6272a4">-- 关闭
</span><span style="color:#6272a4"></span><span style="color:#8be9fd">set</span> autocommit  <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; <span style="color:#6272a4">-- 开启
</span><span style="color:#6272a4"></span>
<span style="color:#6272a4">-- 手动处理事务
</span><span style="color:#6272a4"></span><span style="color:#8be9fd">set</span> autocommit <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; <span style="color:#6272a4">-- 关闭自动提交
</span><span style="color:#6272a4">-- 事务开启
</span><span style="color:#6272a4"></span>start transaction  <span style="color:#6272a4">-- 标记一个事务的开始，从这个之后的SQL都在同一个事务内
</span><span style="color:#6272a4"></span>
<span style="color:#6272a4">-- 提交：：持久化（成功）
</span><span style="color:#6272a4"></span>commit;
<span style="color:#6272a4">-- 回滚：回到原来的样子（失败）
</span><span style="color:#6272a4"></span>rollback;

<span style="color:#6272a4">-- 事物结束
</span><span style="color:#6272a4"></span><span style="color:#8be9fd">set</span> autocommit  <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; <span style="color:#6272a4">-- 开启自动提交
</span><span style="color:#6272a4"></span>
<span style="color:#6272a4">-- 保存点
</span><span style="color:#6272a4"></span>savepoint 保存点名; <span style="color:#6272a4">-- 设置一个事务的保存点
</span><span style="color:#6272a4"></span>rollback <span style="color:#ff79c6">to</span> savepoint 保存点名; <span style="color:#6272a4">-- 回滚到保存点
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">release</span> savepoint 保存点名; <span style="color:#6272a4">-- 撤销保存点
</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#ff79c6">create</span> <span style="color:#ff79c6">database</span> <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">exists</span> <span style="color:#ff79c6">`</span>shop<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">charset</span> <span style="color:#ff79c6">=</span> utf8;
<span style="color:#ff79c6">use</span> shop;

<span style="color:#ff79c6">create</span> <span style="color:#ff79c6">table</span> <span style="color:#ff79c6">`</span>account<span style="color:#ff79c6">`</span>(
    <span style="color:#ff79c6">`</span>id<span style="color:#ff79c6">`</span> <span style="color:#8be9fd">int</span>(<span style="color:#bd93f9">3</span>) <span style="color:#ff79c6">not</span> null <span style="color:#ff79c6">auto_increment</span>,
    <span style="color:#ff79c6">`</span>name<span style="color:#ff79c6">`</span> <span style="color:#8be9fd">varchar</span>(<span style="color:#bd93f9">30</span>) <span style="color:#ff79c6">not</span> null ,
    <span style="color:#ff79c6">`</span>money<span style="color:#ff79c6">`</span> <span style="color:#8be9fd">decimal</span>(<span style="color:#bd93f9">9</span>,<span style="color:#bd93f9">2</span>) <span style="color:#ff79c6">not</span> null ,
    <span style="color:#ff79c6">primary</span> <span style="color:#ff79c6">key</span> (<span style="color:#ff79c6">`</span>id<span style="color:#ff79c6">`</span>)
)<span style="color:#ff79c6">engine</span><span style="color:#ff79c6">=</span>INNODB <span style="color:#ff79c6">default</span> <span style="color:#ff79c6">charset</span><span style="color:#ff79c6">=</span>utf8;

<span style="color:#ff79c6">insert</span> <span style="color:#ff79c6">into</span> <span style="color:#50fa7b">account</span> (<span style="color:#ff79c6">`</span>name<span style="color:#ff79c6">`</span>,<span style="color:#ff79c6">`</span>money<span style="color:#ff79c6">`</span>)
<span style="color:#ff79c6">values</span> (<span style="color:#f1fa8c">&#39;A&#39;</span>,<span style="color:#bd93f9">2000</span>.<span style="color:#bd93f9">00</span>),(<span style="color:#f1fa8c">&#39;B&#39;</span>,<span style="color:#bd93f9">10000</span>.<span style="color:#bd93f9">00</span>);

<span style="color:#6272a4">-- 模拟转账
</span><span style="color:#6272a4"></span><span style="color:#8be9fd">set</span> autocommit <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; <span style="color:#6272a4">-- 关闭自动提交
</span><span style="color:#6272a4"></span>
start transaction ;  <span style="color:#6272a4">-- 开启一个事务
</span><span style="color:#6272a4"></span>
<span style="color:#ff79c6">update</span> account <span style="color:#8be9fd">set</span> money <span style="color:#ff79c6">=</span> money<span style="color:#ff79c6">-</span><span style="color:#bd93f9">500</span> <span style="color:#ff79c6">where</span> <span style="color:#ff79c6">`</span>name<span style="color:#ff79c6">`=</span><span style="color:#f1fa8c">&#39;A&#39;</span>;
<span style="color:#ff79c6">update</span> account <span style="color:#8be9fd">set</span> money <span style="color:#ff79c6">=</span> money<span style="color:#ff79c6">+</span><span style="color:#bd93f9">500</span> <span style="color:#ff79c6">where</span> <span style="color:#ff79c6">`</span>name<span style="color:#ff79c6">`=</span><span style="color:#f1fa8c">&#39;B&#39;</span>;

commit ; <span style="color:#6272a4">-- 提交事务
</span><span style="color:#6272a4"></span>rollback ; <span style="color:#6272a4">-- 回滚（如果上面提交成功了，就无法回滚）
</span><span style="color:#6272a4"></span>
<span style="color:#8be9fd">set</span> autocommit <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>;<span style="color:#6272a4">-- 恢复默认值
</span><span style="color:#6272a4"></span>
<span style="color:#6272a4">-- 一定要一步一步执行！！
</span></code></pre></div><h1 id="7-索引">7. 索引</h1>
<p>索引（index）是帮助mysql高效获取数据的<strong>数据结构</strong></p>
<h2 id="71-索引的分类">7.1 索引的分类</h2>
<ul>
<li>
<p>主键索引 （primary key）</p>
<ul>
<li>唯一的标识，主键不可重复，只能有一个列作为主键</li>
</ul>
</li>
<li>
<p>唯一索引 （unique key）</p>
<ul>
<li>避免重复的列出现，多个列都可以标识为 唯一索引</li>
</ul>
</li>
<li>
<p>常规索引 （key/index）</p>
<ul>
<li>默认的</li>
</ul>
</li>
<li>
<p>全文索引 （fulltext）</p>
<ul>
<li>
<p>快速定位数据</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#ff79c6">select</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">from</span> student <span style="color:#ff79c6">where</span> <span style="color:#ff79c6">match</span>(studentName) <span style="color:#50fa7b">against</span>(<span style="color:#f1fa8c">&#39;刘&#39;</span>)
</code></pre></div></li>
</ul>
</li>
</ul>
<p>添加索引</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#bd93f9">1</span>.添加PRIMARY <span style="color:#ff79c6">KEY</span>(主键索引)

<span style="color:#ff79c6">alter</span> <span style="color:#ff79c6">table</span> <span style="color:#ff79c6">`</span>table_name<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">add</span> <span style="color:#ff79c6">primary</span> <span style="color:#ff79c6">key</span>(<span style="color:#ff79c6">`</span><span style="color:#ff79c6">column</span><span style="color:#ff79c6">`</span>);

<span style="color:#bd93f9">2</span>.添加<span style="color:#50fa7b">UNIQUE</span>(唯一索引)

<span style="color:#ff79c6">alter</span> <span style="color:#ff79c6">table</span> <span style="color:#ff79c6">`</span>table_name<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">add</span> <span style="color:#ff79c6">unique</span>(<span style="color:#ff79c6">`</span><span style="color:#ff79c6">column</span><span style="color:#ff79c6">`</span>);

<span style="color:#bd93f9">3</span>.添加普通索引

<span style="color:#ff79c6">alter</span> <span style="color:#ff79c6">table</span> <span style="color:#ff79c6">`</span>table_name<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">add</span> <span style="color:#ff79c6">index</span> <span style="color:#50fa7b">index_name</span>(<span style="color:#ff79c6">`</span><span style="color:#ff79c6">column</span><span style="color:#ff79c6">`</span>);

<span style="color:#bd93f9">4</span>.添加全文索引

<span style="color:#ff79c6">alter</span> <span style="color:#ff79c6">table</span> <span style="color:#ff79c6">`</span>table_name<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">add</span> <span style="color:#ff79c6">fulltext</span>(<span style="color:#ff79c6">`</span><span style="color:#ff79c6">column</span><span style="color:#ff79c6">`</span>);

<span style="color:#bd93f9">5</span>.添加多列索引

<span style="color:#ff79c6">alter</span> <span style="color:#ff79c6">table</span> <span style="color:#ff79c6">`</span>table_name<span style="color:#ff79c6">`</span> <span style="color:#ff79c6">add</span> <span style="color:#ff79c6">index</span> <span style="color:#50fa7b">index_name</span>(<span style="color:#ff79c6">`</span>column1<span style="color:#ff79c6">`</span>,<span style="color:#ff79c6">`</span>column2<span style="color:#ff79c6">`</span>,<span style="color:#ff79c6">`</span>column3<span style="color:#ff79c6">`</span>);

</code></pre></div><p>索引在小数据量的时候，用处不大，但是在大数据的时候，区别十分明显</p>
<h2 id="72-索引原则">7.2 索引原则</h2>
<ul>
<li>索引不是越多越好</li>
<li>不要对进程变动加索引</li>
<li>小数据量的表不需要加索引</li>
<li>索引一般加在常用来查询的字段上</li>
</ul>
<p>索引的数据结构：</p>
<p><a href="https://blog.codinglabs.org/articles/theory-of-mysql-index.html">https://blog.codinglabs.org/articles/theory-of-mysql-index.html</a></p>
<h1 id="8-权限管理和备份">8. 权限管理和备份</h1>
<h2 id="81-用户管理">8.1 用户管理</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#6272a4">-- 创建用户 create user 用户名 identified by &#39;密码&#39;
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">create</span> <span style="color:#ff79c6">user</span> dovelee <span style="color:#ff79c6">identified</span> <span style="color:#ff79c6">by</span> <span style="color:#f1fa8c">&#39;000319&#39;</span>;

<span style="color:#6272a4">-- 修改当前用户密码
</span><span style="color:#6272a4"></span><span style="color:#8be9fd">set</span> password <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">password</span> (<span style="color:#f1fa8c">&#39;111111&#39;</span>);

<span style="color:#6272a4">-- 修改指定用户密码
</span><span style="color:#6272a4"></span><span style="color:#8be9fd">set</span> password <span style="color:#ff79c6">for</span> dovelee <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">password</span> (<span style="color:#f1fa8c">&#39;111111&#39;</span>);

<span style="color:#6272a4">-- 重命名 rename user 原名字 to 新名字;
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">rename</span> <span style="color:#ff79c6">user</span> dovelee <span style="color:#ff79c6">to</span> dovelee2;

<span style="color:#6272a4">-- 用户授权(授予全部的权限，库，表)
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">grant</span> <span style="color:#ff79c6">all</span> <span style="color:#ff79c6">privileges</span> <span style="color:#ff79c6">on</span> <span style="color:#ff79c6">*</span>.<span style="color:#ff79c6">*</span> <span style="color:#ff79c6">to</span> dovelee

<span style="color:#6272a4">-- 查看指定用户的权限
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">show</span> grants <span style="color:#ff79c6">for</span> dovelee; <span style="color:#6272a4">-- GRANT ALL PRIVILEGES ON *.* TO &#39;dovelee&#39;@&#39;%&#39;
</span><span style="color:#6272a4">-- 查看root用户权限
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">show</span> grants  <span style="color:#ff79c6">for</span> root<span style="color:#ff79c6">@</span>localhost; <span style="color:#6272a4">-- GRANT PROXY ON &#39;&#39;@&#39;&#39; TO &#39;root&#39;@&#39;localhost&#39; WITH GRANT OPTION
</span><span style="color:#6272a4"></span>
<span style="color:#6272a4">-- 撤销权限(撤销全部权限)
</span><span style="color:#6272a4">-- revoke 什么权限 on 哪个库.哪个表 from 哪个用户
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">revoke</span> <span style="color:#ff79c6">all</span> <span style="color:#ff79c6">privileges</span> <span style="color:#ff79c6">on</span> <span style="color:#ff79c6">*</span>.<span style="color:#ff79c6">*</span> <span style="color:#ff79c6">from</span> dovelee;

<span style="color:#6272a4">-- 删除用户
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">drop</span> <span style="color:#ff79c6">user</span> dovelee;
</code></pre></div><h2 id="82-mysql备份">8.2 MySQL备份</h2>
<p>为什么要备份：</p>
<ul>
<li>保证重要的数据不丢失</li>
<li>数据转移</li>
</ul>
<p>MySQL数据库的备份方式</p>
<ul>
<li>直接拷贝物理文件</li>
<li>在可视化工具中手动导出</li>
<li>命令行导出 mysqldump</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#6272a4"># mysqldump -h主机名 -u用户名 -p密码 数据库 表名1 表名2 &gt;打算存储到的路径</span>
mysqldump -hlocalhost -uroot -p123456 school student result &gt;D:/a.sql
</code></pre></div><ul>
<li>命令行导入</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#6272a4"># 在登录的情况下</span>
use 数据库名
<span style="color:#8be9fd;font-style:italic">source</span> 导入文件路径
</code></pre></div><h1 id="9-规范数据库设计">9. 规范数据库设计</h1>
<h2 id="91-为什么需要设计数据库">9.1 为什么需要设计数据库</h2>
<p>当数据库比较复杂时，数据库就需要设计了</p>
<p>糟糕的数据库设计：</p>
<ul>
<li>数据冗余，浪费时间</li>
<li>数据库插入和删除都会麻烦、异常【屏蔽使用物理外键】</li>
<li>程序性能差</li>
</ul>
<p>良好的数据库设计</p>
<ul>
<li>节省内存空间</li>
<li>保证数据库的完整性</li>
<li>方便我们开发</li>
</ul>
<p><strong>软件开发中，关于数据库的设计</strong></p>
<ul>
<li>分析需求：分析业务和需要处理的数据库的需求</li>
<li>概要设计：设计关系图E-R图</li>
</ul>
<p><strong>设计数据库的步骤：（个人博客）</strong></p>
<ul>
<li>收集信息，分析需求
<ul>
<li>用户表（用户登录注销，个人信息，写博客，创建分类）</li>
<li>分类表（文章分类，谁创建的）</li>
<li>文章表（文章的信息）</li>
<li>评论表</li>
<li>友情链接表（友情链接信息）</li>
<li>自定义表（系统信息，某个关键字，主题）：当个字典用key-value</li>
</ul>
</li>
<li>标识实体（把需求落地到每个字段）</li>
<li>标识实体之间的关系</li>
</ul>
<h2 id="92-三大范式">9.2 三大范式</h2>
<p><strong>为什么需要数据规范化？</strong></p>
<ul>
<li>信息重复</li>
<li>更新异常</li>
<li>插入异常
<ul>
<li>无法正常显示信息</li>
</ul>
</li>
<li>删除异常
<ul>
<li>丢失有效的信息</li>
</ul>
</li>
</ul>
<p><strong>三大范式：</strong></p>
<p><strong>第一范式：</strong></p>
<p>​	原子性，保持每一列不可再分</p>
<p><strong>第二范式：</strong></p>
<p>​	满足第一范式为前提</p>
<p>​	每张表只描述一件事情</p>
<p><strong>第三范式</strong></p>
<p>​	满足第二范式为前提</p>
<p>​	确保数据表中的每一列数据都和主键直接相关，而不能间接相关</p>
<blockquote>
<p>参考链接：https://www.cnblogs.com/wsg25/p/9615100.html</p>
</blockquote>
<p><strong>规范性和性能的问题</strong></p>
<p>关联查询的表不得超过三张表</p>
<ul>
<li>考虑商业化的需求和目标（成本，用户体验），数据库的性能更为重要</li>
<li>在提升性能的同时，需要适当的考虑规范性</li>
<li>故意给某些表增加以下冗余的字段。（从多表查询变为单表查询）</li>
<li>故意增加计算列或索引（从大数量查询编程小数量查询）</li>
</ul>
<h1 id="10-jdbc">10. JDBC</h1>
<h2 id="101-数据库驱动">10.1 数据库驱动</h2>
<p>我们的程序通过数据库驱动和数据库打交道</p>
<h2 id="102-jdbc">10.2 JDBC</h2>
<p>sun公司为了简化开发人员的（对数据库它的统一）操作，提供了一个（Java操作数据库的）规范，JDBC</p>
<p>对于开发人员，只需要掌握JDBC接口的操作即可</p>
<h2 id="103-第一个jdbc程序">10.3 第一个JDBC程序</h2>
<p>创建测试数据库：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#ff79c6">CREATE</span> <span style="color:#ff79c6">DATABASE</span> jdbcStudy <span style="color:#ff79c6">CHARACTER</span> <span style="color:#8be9fd">SET</span> utf8 <span style="color:#ff79c6">COLLATE</span> utf8_general_ci;

<span style="color:#ff79c6">USE</span> jdbcStudy;

<span style="color:#ff79c6">CREATE</span> <span style="color:#ff79c6">TABLE</span> <span style="color:#ff79c6">`</span>users<span style="color:#ff79c6">`</span>(
id <span style="color:#8be9fd">INT</span> <span style="color:#ff79c6">PRIMARY</span> <span style="color:#ff79c6">KEY</span>,
NAME <span style="color:#8be9fd">VARCHAR</span>(<span style="color:#bd93f9">40</span>),
PASSWORD <span style="color:#8be9fd">VARCHAR</span>(<span style="color:#bd93f9">40</span>),
email <span style="color:#8be9fd">VARCHAR</span>(<span style="color:#bd93f9">60</span>),
birthday <span style="color:#8be9fd">DATE</span>
);

<span style="color:#ff79c6">INSERT</span> <span style="color:#ff79c6">INTO</span> <span style="color:#ff79c6">`</span>users<span style="color:#ff79c6">`</span>(id,NAME,PASSWORD,email,birthday)
<span style="color:#ff79c6">VALUES</span>(<span style="color:#bd93f9">1</span>,<span style="color:#f1fa8c">&#39;zhansan&#39;</span>,<span style="color:#f1fa8c">&#39;123456&#39;</span>,<span style="color:#f1fa8c">&#39;zs@sina.com&#39;</span>,<span style="color:#f1fa8c">&#39;1980-12-04&#39;</span>),
(<span style="color:#bd93f9">2</span>,<span style="color:#f1fa8c">&#39;lisi&#39;</span>,<span style="color:#f1fa8c">&#39;123456&#39;</span>,<span style="color:#f1fa8c">&#39;lisi@sina.com&#39;</span>,<span style="color:#f1fa8c">&#39;1981-12-04&#39;</span>),
(<span style="color:#bd93f9">3</span>,<span style="color:#f1fa8c">&#39;wangwu&#39;</span>,<span style="color:#f1fa8c">&#39;123456&#39;</span>,<span style="color:#f1fa8c">&#39;wangwu@sina.com&#39;</span>,<span style="color:#f1fa8c">&#39;1979-12-04&#39;</span>)
</code></pre></div><ol>
<li>
<p>创建一个Maven项目</p>
</li>
<li>
<p>导入数据库驱动</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"> <span style="color:#ff79c6">&lt;dependency&gt;</span>
            <span style="color:#ff79c6">&lt;groupId&gt;</span>mysql<span style="color:#ff79c6">&lt;/groupId&gt;</span>
            <span style="color:#ff79c6">&lt;artifactId&gt;</span>mysql-connector-java<span style="color:#ff79c6">&lt;/artifactId&gt;</span>
            <span style="color:#ff79c6">&lt;version&gt;</span>5.1.47<span style="color:#ff79c6">&lt;/version&gt;</span>
        <span style="color:#ff79c6">&lt;/dependency&gt;</span>
</code></pre></div></li>
<li>
<p>编写第一个JDBC程序</p>
</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">JDBC_demo1</span> <span style="color:#ff79c6">{</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">main</span><span style="color:#ff79c6">(</span>String<span style="color:#ff79c6">[]</span> args<span style="color:#ff79c6">)</span> <span style="color:#8be9fd;font-style:italic">throws</span> ClassNotFoundException<span style="color:#ff79c6">,</span> SQLException <span style="color:#ff79c6">{</span>
<span style="color:#6272a4">//        1.加载驱动
</span><span style="color:#6272a4"></span>        Class<span style="color:#ff79c6">.</span><span style="color:#50fa7b">forName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;com.mysql.jdbc.Driver&#34;</span><span style="color:#ff79c6">);</span><span style="color:#6272a4">//固定写法
</span><span style="color:#6272a4">//        2.用户信息url
</span><span style="color:#6272a4"></span>        String url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;jdbc:mysql://localhost:3306/jdbcstudy?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false&#34;</span><span style="color:#ff79c6">;</span>
        String username <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;root&#34;</span><span style="color:#ff79c6">;</span>
        String password <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;000319&#34;</span><span style="color:#ff79c6">;</span>
<span style="color:#6272a4">//        3.连接成功，数据库对象Connection代表数据库  数据库设置自动提交，事务提交，事务回滚
</span><span style="color:#6272a4"></span>        Connection connection <span style="color:#ff79c6">=</span> DriverManager<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getConnection</span><span style="color:#ff79c6">(</span>url<span style="color:#ff79c6">,</span> username<span style="color:#ff79c6">,</span> password<span style="color:#ff79c6">);</span>
<span style="color:#6272a4">//        4.创建SQL对象 Statement：执行sql的对象 负责查询，遍历，指针
</span><span style="color:#6272a4"></span>        Statement statement <span style="color:#ff79c6">=</span> connection<span style="color:#ff79c6">.</span><span style="color:#50fa7b">createStatement</span><span style="color:#ff79c6">();</span>
<span style="color:#6272a4">//        5.执行SQL对象 可能存在返回结果，查看返回结果
</span><span style="color:#6272a4"></span>        String sql <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;select * from users&#34;</span><span style="color:#ff79c6">;</span>

        ResultSet resultSet <span style="color:#ff79c6">=</span> statement<span style="color:#ff79c6">.</span><span style="color:#50fa7b">executeQuery</span><span style="color:#ff79c6">(</span>sql<span style="color:#ff79c6">);</span>

        <span style="color:#ff79c6">while</span><span style="color:#ff79c6">(</span>resultSet<span style="color:#ff79c6">.</span><span style="color:#50fa7b">next</span><span style="color:#ff79c6">()){</span>
            System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;id=&#34;</span> <span style="color:#ff79c6">+</span> resultSet<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getObject</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;id&#34;</span><span style="color:#ff79c6">));</span>
            System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;name=&#34;</span> <span style="color:#ff79c6">+</span> resultSet<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getObject</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;NAME&#34;</span><span style="color:#ff79c6">));</span>
            System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;pwd=&#34;</span> <span style="color:#ff79c6">+</span> resultSet<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getObject</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;PASSWORD&#34;</span><span style="color:#ff79c6">));</span>
            System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;email=&#34;</span> <span style="color:#ff79c6">+</span> resultSet<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getObject</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;email&#34;</span><span style="color:#ff79c6">));</span>
            System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;birthday=&#34;</span> <span style="color:#ff79c6">+</span> resultSet<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getObject</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;birthday&#34;</span><span style="color:#ff79c6">));</span>
            System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;=================================================&#34;</span><span style="color:#ff79c6">);</span>
        <span style="color:#ff79c6">}</span>
<span style="color:#6272a4">//        6.释放连接
</span><span style="color:#6272a4"></span>        resultSet<span style="color:#ff79c6">.</span><span style="color:#50fa7b">close</span><span style="color:#ff79c6">();;</span>
        statement<span style="color:#ff79c6">.</span><span style="color:#50fa7b">close</span><span style="color:#ff79c6">();</span>
        connection<span style="color:#ff79c6">.</span><span style="color:#50fa7b">close</span><span style="color:#ff79c6">();</span>
    <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span>

运行结果：
id<span style="color:#ff79c6">=</span>1
name<span style="color:#ff79c6">=</span>zhangsan
pwd<span style="color:#ff79c6">=</span>123456
email<span style="color:#ff79c6">=</span>zs@sina.com
birthday<span style="color:#ff79c6">=</span>1980<span style="color:#ff79c6">-</span>12<span style="color:#ff79c6">-</span>04
<span style="color:#ff79c6">=================================================</span>
id<span style="color:#ff79c6">=</span>2
name<span style="color:#ff79c6">=</span>lisi
pwd<span style="color:#ff79c6">=</span>123456
email<span style="color:#ff79c6">=</span>lisi@sina.com
birthday<span style="color:#ff79c6">=</span>1981<span style="color:#ff79c6">-</span>12<span style="color:#ff79c6">-</span>04
<span style="color:#ff79c6">=================================================</span>
id<span style="color:#ff79c6">=</span>3
name<span style="color:#ff79c6">=</span>wangwu
pwd<span style="color:#ff79c6">=</span>123456
email<span style="color:#ff79c6">=</span>wangwu@sina.com
birthday<span style="color:#ff79c6">=</span>1979<span style="color:#ff79c6">-</span>12<span style="color:#ff79c6">-</span>04
<span style="color:#ff79c6">=================================================</span>
</code></pre></div><p>遇到问题：error：JAVA不支持发行版本</p>
<p><img src="https://user-images.githubusercontent.com/58317994/87870688-03fba400-c9dd-11ea-817f-ef9fa788553b.jpg" alt=""></p>
<h2 id="104-preparedstatement对象">10.4 PreparedStatement对象</h2>
<p>可以防止SQL注入，效率更高</p>
<p>防止SQL注入的本质，把传递进来的参数当做字符</p>
<h2 id="105-事务">10.5 事务</h2>
<ol>
<li>开启事务 connection.setAutoCommit(false)</li>
<li>一组业务执行完毕，提交事务</li>
<li>可以在catch语句中显式的定义回滚语句，但默认失败就会回滚</li>
</ol>
<h2 id="106-数据库连接池">10.6 数据库连接池</h2>
<p>数据库连接&mdash;执行完毕&mdash;释放</p>
<p>其中连接&ndash;释放 十分浪费资源</p>
<p>池化技术：预先准备一些资源，过来就连接预先准备好的</p>
<p>常用连接数：</p>
<p>最小连接数：</p>
<p>最大连接数：业务最高承载上限</p>
<p>等待超时：</p>
<p>编写连接池，只需要实现一个接口DataSource</p>
<p>开源数据源实现：DBCP C3P0 Druid</p>
<p>使用了这些数据库连接池之后，我们在项目开发中就不需要编写连接数据库的代码了</p>
<p>DBCP需要用到的jar包：commons-dbcp-1.4、commons-pool-1.6</p>
<p>C3P0需要用到的jar包：https://sourceforge.net/projects/c3p0/files/latest/download?source=files</p>


                
                
<div class="entry-shang text-center">
    
	    <p> 「如果这篇文章对你有用,请随意打赏」</p>
	
	<button class="zs show-zs btn btn-bred">赞赏支持</button>
</div>
<div class="zs-modal-bg"></div>
<div class="zs-modal-box">
	<div class="zs-modal-head">
		<button type="button" class="close">×</button>
		<span class="author"><a href="https://dovelee-hub.github.io/"><img src="/img/favicon.png" />Mr.Lee&#39;s Blog</a></span>
        
	        <p class="tip"><i></i><span>如果这篇文章对你有用,请随意打赏</span></p>
		
 
	</div>
	<div class="zs-modal-body">
		<div class="zs-modal-btns">
			<button class="btn btn-blink" data-num="2">2元</button>
			<button class="btn btn-blink" data-num="5">5元</button>
			<button class="btn btn-blink" data-num="10">10元</button>
			<button class="btn btn-blink" data-num="50">50元</button>
			<button class="btn btn-blink" data-num="100">100元</button>
			<button class="btn btn-blink" data-num="1">任意金额</button>
		</div>
		<div class="zs-modal-pay">
			<button class="btn btn-bred" id="pay-text">2元</button>
			<p>使用<span id="pay-type">微信</span>扫描二维码完成支付</p>
			<img src="/img/reward/wechat-2.png"  id="pay-image"/>
		</div>
	</div>
	<div class="zs-modal-footer">
		<label><input type="radio" name="zs-type" value="wechat" class="zs-type" checked="checked"><span ><span class="zs-wechat"><img src="/img/reward/wechat-btn.png"/></span></label>
		<label><input type="radio" name="zs-type" value="alipay" class="zs-type" class="zs-alipay"><img src="/img/reward/alipay-btn.png"/></span></label>
	</div>
</div>
<script type="text/javascript" src="/js/reward.js"></script>

                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/java_web/" data-toggle="tooltip" data-placement="top" title="JavaWeb">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                </ul>

                
<div id="disqus-comment"></div>



            </div>
            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                    </div>
                </section>
                

                
                
                <section>
                    <hr>
                    <h5>FRIENDS</h5>
                    <ul class="list-inline">
                        
                        <li><a target="_blank" href=""></a></li>
                        
                    </ul>
                </section>
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                   <li>
                       <a href='' rel="alternate" type="application/rss+xml" title="Mr.Lee&#39;s Blog" >
                           <span class="fa-stack fa-lg">
                               <i class="fa fa-circle fa-stack-2x"></i>
                               <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                           </span>
                       </a>
                   </li>
                   
                    
                    <li>
                        <a href="mailto:958055356@qq.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    

                    

		    
                    
                    <li>
                        <a target="_blank" href="https://user-images.githubusercontent.com/58317994/82021498-81ddbf00-96bd-11ea-84c9-d75115690261.JPG">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-wechat fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    <li>
                        <a target="_blank" href="https://github.com/DoveLee-hub">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    
                    
                    
                    
                    
            
            
            
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; Mr.Lee&#39;s Blog 2020
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a> by <a href="https://zhaohuabing.com">Huabing</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>






</body>
</html>
